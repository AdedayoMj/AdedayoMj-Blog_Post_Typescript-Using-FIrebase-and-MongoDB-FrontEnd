{"ast":null,"code":"var _jsxFileName = \"/Users/macbook/quiz_run/quizrun/src/pages/edit.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useContext, useEffect, useState } from 'react';\nimport { ContentState, EditorState, convertToRaw } from 'draft-js';\nimport UserContext from '../context/user';\nimport { Link, withRouter } from 'react-router-dom';\nimport axios from 'axios';\nimport config from '../config/config';\nimport logging from '../config/logging';\nimport htmlToDraft from 'html-to-draftjs';\nimport LoadingComponent from '../components/loading_components';\nimport draftToHtml from 'draftjs-to-html';\nimport { Editor } from 'react-draft-wysiwyg';\nimport { Container, Form, FormGroup, Label, Input, Button } from 'reactstrap';\nimport ErrorText from '../components/error_text';\nimport Header from '../components/header';\nimport SuccessText from '../components/success_text';\nimport \"react-draft-wysiwyg/dist/react-draft-wysiwyg.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst EditPage = props => {\n  _s();\n\n  const [_id, setId] = useState('');\n  const [title, setTitle] = useState('');\n  const [picture, setPicture] = useState('');\n  const [content, setContent] = useState('');\n  const [headline, setHeadline] = useState('');\n  const [editorState, setEditorState] = useState(EditorState.createEmpty());\n  const [saving, setSaving] = useState(false);\n  const [loading, setLoading] = useState(true);\n  const [success, setSuccess] = useState('');\n  const [error, setError] = useState('');\n  const {\n    user\n  } = useContext(UserContext).userState;\n  useEffect(() => {\n    let blogID = props.match.params.blogID;\n\n    if (blogID) {\n      setId(blogID);\n      getBlog(blogID);\n    } else {\n      setLoading(false);\n    } // eslint-disable-next-line\n\n  }, []);\n\n  const getBlog = async id => {\n    try {\n      const response = await axios({\n        method: 'GET',\n        url: `${config.server.url}/blogs/read/${id}`\n      });\n\n      if (response.status === (200 || 304)) {\n        if (user._id !== response.data.blog.author._id) {\n          logging.warn(`This blog is owned by someone else.`);\n          setId('');\n        } else {\n          let blog = response.data.blog;\n          setTitle(blog.title);\n          setContent(blog.content);\n          setHeadline(blog.headline);\n          setPicture(blog.picture || '');\n          /** Convert html string to draft JS */\n\n          const contentBlock = htmlToDraft(blog.content);\n          const contentState = ContentState.createFromBlockArray(contentBlock.contentBlocks);\n          const editorState = EditorState.createWithContent(contentState);\n          setEditorState(editorState);\n        }\n      } else {\n        setError(`Unable to retrieve blog ${_id}`);\n      }\n    } catch (error) {\n      setError(error.message);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const createBlog = async () => {\n    if (title === '' || headline === '' || content === '') {\n      setError('Please fill out all fields.');\n      setSuccess('');\n      return null;\n    }\n\n    setError('');\n    setSuccess('');\n    setSaving(true);\n\n    try {\n      const response = await axios({\n        method: 'POST',\n        url: `${config.server.url}/blogs/create`,\n        data: {\n          title,\n          picture,\n          headline,\n          content,\n          author: user._id\n        }\n      });\n\n      if (response.status === 201) {\n        setId(response.data.blog._id);\n        setSuccess('Blog posted.  You can continue to edit on this page.');\n      } else {\n        setError(`Unable to save blog.`);\n      }\n    } catch (error) {\n      setError(error.message);\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const editBlog = async () => {\n    if (title === '' || headline === '' || content === '') {\n      setError('Please fill out all fields.');\n      setSuccess('');\n      return null;\n    }\n\n    setError('');\n    setSuccess('');\n    setSaving(true);\n\n    try {\n      const response = await axios({\n        method: 'PATCH',\n        url: `${config.server.url}/blogs/update/${_id}`,\n        data: {\n          title,\n          picture,\n          headline,\n          content\n        }\n      });\n\n      if (response.status === 201) {\n        setSuccess('Blog updated.');\n      } else {\n        setError(`Unable to save blog.`);\n      }\n    } catch (error) {\n      setError(error.message);\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  if (loading) return /*#__PURE__*/_jsxDEV(LoadingComponent, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 189,\n    columnNumber: 25\n  }, this);\n  return /*#__PURE__*/_jsxDEV(Container, {\n    fluid: true,\n    className: \"p-0\",\n    style: {\n      color: \"white\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(Header, {\n      image: \"https://startbootstrap.github.io/startbootstrap-clean-blog/img/home-bg.jpg\",\n      headline: \"\",\n      title: _id !== '' ? 'Edit Your Blog' : 'Create a Blog'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 1\n    }, this), /*#__PURE__*/_jsxDEV(Container, {\n      className: \"mt-5 mb-5\",\n      children: [/*#__PURE__*/_jsxDEV(ErrorText, {\n        error: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Form, {\n        children: [/*#__PURE__*/_jsxDEV(FormGroup, {\n          children: [/*#__PURE__*/_jsxDEV(Label, {\n            for: \"title\",\n            children: \"Title\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 201,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Input, {\n            type: \"text\",\n            name: \"title\",\n            value: title,\n            id: \"title\",\n            placeholder: \"Enter a title\",\n            disabled: saving,\n            onChange: event => {\n              setTitle(event.target.value);\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 202,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 200,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(FormGroup, {\n          children: [/*#__PURE__*/_jsxDEV(Label, {\n            for: \"picture\",\n            children: \"Picture URL\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 215,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Input, {\n            type: \"text\",\n            name: \"picture\",\n            value: picture,\n            id: \"picture\",\n            placeholder: \"Picture URL\",\n            disabled: saving,\n            onChange: event => {\n              setPicture(event.target.value);\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 216,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 214,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(FormGroup, {\n          children: [/*#__PURE__*/_jsxDEV(Label, {\n            for: \"headline\",\n            children: \"Headline\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 229,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Input, {\n            type: \"text\",\n            name: \"headline\",\n            value: headline,\n            id: \"headline\",\n            placeholder: \"Enter a headline\",\n            disabled: saving,\n            onChange: event => {\n              setHeadline(event.target.value);\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 230,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(FormGroup, {\n          children: [/*#__PURE__*/_jsxDEV(Label, {\n            children: \"Content\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 243,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Editor, {\n            editorState: editorState,\n            wrapperClassName: \"card\",\n            editorClassName: \"card-body\",\n            onEditorStateChange: newState => {\n              setEditorState(newState);\n              setContent(draftToHtml(convertToRaw(newState.getCurrentContent())));\n            },\n            toolbar: {\n              options: ['inline', 'blockType', 'fontSize', 'list', 'textAlign', 'history', 'embedded', 'emoji', 'image'],\n              inline: {\n                inDropdown: true\n              },\n              list: {\n                inDropdown: true\n              },\n              textAlign: {\n                inDropdown: true\n              },\n              link: {\n                inDropdown: true\n              },\n              history: {\n                inDropdown: true\n              }\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 244,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 242,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(FormGroup, {\n          children: /*#__PURE__*/_jsxDEV(SuccessText, {\n            success: success\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 263,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 262,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(FormGroup, {\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            style: {\n              backgroundColor: \"#222454\"\n            },\n            block: true,\n            onClick: () => {\n              if (_id !== '') {\n                editBlog();\n              } else {\n                createBlog();\n              }\n            },\n            disabled: saving,\n            children: [/*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fas fa-save mr-1\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 281,\n              columnNumber: 29\n            }, this), _id !== '' ? \"Update\" : \"Post\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 266,\n            columnNumber: 25\n          }, this), _id !== '' && /*#__PURE__*/_jsxDEV(Button, {\n            block: true,\n            color: \"success\",\n            tag: Link,\n            to: `/blogs/${_id}`,\n            children: \"Go to your blog post!\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 289,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 265,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(FormGroup, {\n          children: [/*#__PURE__*/_jsxDEV(Label, {\n            children: \"Preview\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 295,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"border ql-container p-2\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              dangerouslySetInnerHTML: {\n                __html: content\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 297,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 296,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 294,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(ErrorText, {\n        error: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 305,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 191,\n    columnNumber: 9\n  }, this);\n};\n\n_s(EditPage, \"Czlv8sMrzZECvRs5Y+g63HtUF4g=\");\n\n_c = EditPage;\nexport default _c2 = withRouter(EditPage);\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"EditPage\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"sources":["/Users/macbook/quiz_run/quizrun/src/pages/edit.tsx"],"names":["React","useContext","useEffect","useState","ContentState","EditorState","convertToRaw","UserContext","Link","withRouter","axios","config","logging","htmlToDraft","LoadingComponent","draftToHtml","Editor","Container","Form","FormGroup","Label","Input","Button","ErrorText","Header","SuccessText","EditPage","props","_id","setId","title","setTitle","picture","setPicture","content","setContent","headline","setHeadline","editorState","setEditorState","createEmpty","saving","setSaving","loading","setLoading","success","setSuccess","error","setError","user","userState","blogID","match","params","getBlog","id","response","method","url","server","status","data","blog","author","warn","contentBlock","contentState","createFromBlockArray","contentBlocks","createWithContent","message","createBlog","editBlog","color","event","target","value","newState","getCurrentContent","options","inline","inDropdown","list","textAlign","link","history","backgroundColor","__html"],"mappings":"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","sourcesContent":["\nimport React, { useContext, useEffect, useState } from 'react'\nimport IPageProps from \"../interfaces/pages\";\nimport { ContentState, EditorState,convertToRaw } from 'draft-js';\nimport UserContext from '../context/user';\nimport { Link, RouteComponentProps, withRouter } from 'react-router-dom';\nimport axios from 'axios';\nimport config from '../config/config';\nimport logging from '../config/logging';\nimport htmlToDraft from 'html-to-draftjs';\nimport IBlog from '../interfaces/blog';\nimport LoadingComponent from '../components/loading_components';\nimport draftToHtml from 'draftjs-to-html';\nimport { Editor } from 'react-draft-wysiwyg';\nimport { Container, Form, FormGroup, Label, Input, Button } from 'reactstrap';\nimport ErrorText from '../components/error_text';\nimport Header from '../components/header';\nimport SuccessText from '../components/success_text';\nimport \"react-draft-wysiwyg/dist/react-draft-wysiwyg.css\";\n\n\nconst EditPage:React.FunctionComponent<IPageProps & RouteComponentProps<any>>=props=>{\n    const [_id, setId] = useState<string>('');\n    const [title, setTitle] = useState<string>('');\n    const [picture, setPicture] = useState<string>('');\n    const [content, setContent] = useState<string>('');\n    const [headline, setHeadline] = useState<string>('');\n    const [editorState, setEditorState] = useState<EditorState>(EditorState.createEmpty());\n\n    const [saving, setSaving] = useState<boolean>(false);\n    const [loading, setLoading] = useState<boolean>(true);\n    const [success, setSuccess] = useState<string>('');\n    const [error, setError] = useState<string>('');\n\n    const { user } = useContext(UserContext).userState;\n\n\n    useEffect(() => {\n        let blogID = props.match.params.blogID;\n\n        if (blogID)\n        {\n            setId(blogID);\n            getBlog(blogID);\n        }\n        else\n        {\n            setLoading(false);\n        }\n\n        // eslint-disable-next-line\n    }, []);\n\n    const getBlog = async (id: string) => {\n        try \n        {\n            const response = await axios({\n                method: 'GET',\n                url: `${config.server.url}/blogs/read/${id}`,\n            });\n\n            if (response.status === (200 || 304))\n            {\n                if (user._id !== response.data.blog.author._id)\n                {\n                    logging.warn(`This blog is owned by someone else.`);\n                    setId('');\n                }\n                else\n                {\n                    let blog =response.data.blog as IBlog\n                    setTitle(blog.title);\n                    setContent(blog.content);\n                    setHeadline(blog.headline);\n                    setPicture(blog.picture || '');\n                    \n                    /** Convert html string to draft JS */\n                    const contentBlock = htmlToDraft(blog.content);\n                    const contentState = ContentState.createFromBlockArray(contentBlock.contentBlocks);\n                    const editorState = EditorState.createWithContent(contentState);\n\n                    setEditorState(editorState);\n                }\n            }\n            else\n            {\n                setError(`Unable to retrieve blog ${_id}`);\n            }\n        } \n        catch (error) \n        {\n            setError(error.message);\n        }\n        finally\n        {\n            setLoading(false);\n        }\n    }\n    const createBlog = async () => {\n        if (title === '' || headline === '' || content === '')\n        {\n            setError('Please fill out all fields.');\n            setSuccess('');\n            return null;\n        }\n\n        setError('');\n        setSuccess('');\n        setSaving(true);\n\n        try \n        {\n            const response = await axios({\n                method: 'POST',\n                url: `${config.server.url}/blogs/create`,\n                data: {\n                    title,\n                    picture,\n                    headline,\n                    content,\n                    author: user._id\n                }\n            });\n\n            if (response.status === 201)\n            {\n                setId(response.data.blog._id);\n                setSuccess('Blog posted.  You can continue to edit on this page.');\n            }\n            else\n            {\n                setError(`Unable to save blog.`);\n            }\n        } \n        catch (error) \n        {\n            setError(error.message);\n        }\n        finally\n        {\n            setSaving(false);\n        }\n    }\n\n    const editBlog = async () => {\n        if (title === '' || headline === '' || content === '')\n        {\n            setError('Please fill out all fields.');\n            setSuccess('');\n            return null;\n        }\n\n        setError('');\n        setSuccess('');\n        setSaving(true);\n        \n        try \n        {\n            const response = await axios({\n                method: 'PATCH',\n                url: `${config.server.url}/blogs/update/${_id}`,\n                data: {\n                    title,\n                    picture,\n                    headline,\n                    content\n                }\n            });\n\n            if (response.status === 201)\n            {\n                setSuccess('Blog updated.');\n            }\n            else\n            {\n                setError(`Unable to save blog.`);\n            }\n        } \n        catch (error) \n        {\n            setError(error.message);\n        }\n        finally\n        {\n            setSaving(false);\n        }\n    }\n\n    if (loading) return <LoadingComponent />;\n    return(\n        <Container fluid className=\"p-0\" style={{color:\"white\"}}>\n<Header\n                image=\"https://startbootstrap.github.io/startbootstrap-clean-blog/img/home-bg.jpg\"\n                headline=\"\"\n                title={_id !== '' ? 'Edit Your Blog' : 'Create a Blog'}\n            />\n            <Container className=\"mt-5 mb-5\">\n                <ErrorText error={error} />\n                <Form>\n                    <FormGroup>\n                        <Label for=\"title\">Title</Label>\n                        <Input \n                            type=\"text\" \n                            name=\"title\"\n                            value={title} \n                            id=\"title\"\n                            placeholder=\"Enter a title\"\n                            disabled={saving}\n                            onChange={event => {\n                                setTitle(event.target.value);\n                            }}\n                        />\n                    </FormGroup>\n                    <FormGroup>\n                        <Label for=\"picture\">Picture URL</Label>\n                        <Input \n                            type=\"text\" \n                            name=\"picture\"\n                            value={picture}\n                            id=\"picture\"\n                            placeholder=\"Picture URL\"\n                            disabled={saving}\n                            onChange={event => {\n                                setPicture(event.target.value);\n                            }}\n                        />\n                    </FormGroup>\n                    <FormGroup>\n                        <Label for=\"headline\">Headline</Label>\n                        <Input \n                            type=\"text\" \n                            name=\"headline\"\n                            value={headline} \n                            id=\"headline\"\n                            placeholder=\"Enter a headline\" \n                            disabled={saving}\n                            onChange={event => {\n                                setHeadline(event.target.value);\n                            }}\n                        />\n                    </FormGroup>\n                    <FormGroup>\n                        <Label>Content</Label>\n                        <Editor\n                            editorState={editorState}\n                            wrapperClassName=\"card\"\n                            editorClassName=\"card-body\"\n                            onEditorStateChange={newState => {\n                                setEditorState(newState);\n                                setContent(draftToHtml(convertToRaw(newState.getCurrentContent())));\n                            }}\n                            toolbar={{\n                                options: ['inline', 'blockType', 'fontSize', 'list', 'textAlign', 'history', 'embedded', 'emoji', 'image'],\n                                inline: { inDropdown: true },\n                                list: { inDropdown: true },\n                                textAlign: { inDropdown: true },\n                                link: { inDropdown: true },\n                                history: { inDropdown: true },\n                            }}\n                        />\n                    </FormGroup>\n                    <FormGroup>\n                        <SuccessText success={success} />\n                    </FormGroup>\n                    <FormGroup>\n                        <Button\n                        style={{backgroundColor:\"#222454\"}}\n                            block\n                            onClick={() => {\n                                if (_id !== '')\n                                {\n                                    editBlog();\n                                }\n                                else\n                                {\n                                    createBlog();\n                                }\n                            }}\n                            disabled={saving}\n                        >\n                            <i className=\"fas fa-save mr-1\"></i> \n                            {_id !== '' ?\n                                \"Update\"\n                            :\n                                \"Post\"\n                            }\n                        </Button>\n                        {_id !== '' &&\n                            <Button block color=\"success\"  tag={Link} to={`/blogs/${_id}`}>\n                                Go to your blog post!\n                            </Button>\n                        }\n                    </FormGroup>\n                    <FormGroup>\n                        <Label>Preview</Label>\n                        <div className=\"border ql-container p-2\">\n                            <div \n                                dangerouslySetInnerHTML={{ \n                                    __html: content\n                                }} \n                            />\n                        </div>\n                    </FormGroup>\n                </Form>\n                <ErrorText error={error} />\n            </Container>\n        </Container>\n       \n    )\n}\n\nexport default withRouter(EditPage);\n\n\n\n\n"]},"metadata":{},"sourceType":"module"}