{"ast":null,"code":"var _jsxFileName = \"/Users/macbook/quiz_run/quizrun/src/pages/login.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useContext, useState } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport UserContext from '../context/user';\nimport { Authenticate, SignInWithSocialMedia as SocialMediaPopup } from '../modules/auth';\nimport logging from '../config/logging';\nimport CenterPiece from '../components/centerpiece';\nimport { Button, Card, CardBody, CardHeader, Container } from 'reactstrap';\nimport ErrorText from '../components/error_text';\nimport LoadingComponent from '../components/loading_components/indes';\nimport { Providers } from '../config/firebase';\nimport Naviagtion from '../components/navigation';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst LoginPage = props => {\n  _s();\n\n  const [authenticating, setAuthenticating] = useState(false);\n  const [error, setError] = useState('');\n  const userContext = useContext(UserContext);\n  const history = useHistory();\n  const isLogin = window.location.pathname.includes('login');\n\n  const signInWithSocialMedia = provider => {\n    if (error !== '') setError('');\n    setAuthenticating(true);\n    SocialMediaPopup(provider).then(async result => {\n      logging.info(result);\n      let user = result.user;\n\n      if (user) {\n        let uid = user.uid;\n        let name = user.displayName;\n        let email = user.email;\n\n        if (name) {\n          try {\n            let fire_token = await user.getIdToken();\n            /**if we get a token, auth with the backup */\n\n            Authenticate(uid, name, email, fire_token, (error, _user) => {\n              if (error) {\n                setError(error);\n                setAuthenticating(false);\n              } else if (_user) {\n                userContext.userDispatch({\n                  type: 'login',\n                  payload: {\n                    user: _user,\n                    fire_token\n                  }\n                });\n                history.push('/');\n              }\n            });\n          } catch (error) {\n            setError('Invalid token.');\n            logging.error(error);\n            setAuthenticating(false);\n          }\n        } else {\n          /**\n           * We can set these manually with a new form\n           * For example, the Twitter provider sometimes\n           * does not provide a username as some users sign\n           * up with a phone number.  Here you could ask\n           * them to provide a name that would be displayed\n           * on this website.\n           * */\n          setError('The identify provider is missing a display name.');\n          setAuthenticating(false);\n        }\n      } else {\n        setError('The social media provider does not have enough information. Please try a different provider.');\n        setAuthenticating(false);\n      }\n    }).catch(error => {\n      logging.error(error);\n      setAuthenticating(false);\n      setError(error.message);\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(Container, {\n    fluid: true,\n    className: \"p-0\",\n    children: [/*#__PURE__*/_jsxDEV(Naviagtion, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(CenterPiece, {\n      children: /*#__PURE__*/_jsxDEV(Card, {\n        children: [/*#__PURE__*/_jsxDEV(CardHeader, {\n          children: isLogin ? 'Login' : 'Sign Up'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(CardBody, {\n          children: [/*#__PURE__*/_jsxDEV(ErrorText, {\n            error: error\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 87,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            block: true,\n            disabled: authenticating,\n            onClick: () => signInWithSocialMedia(Providers.google),\n            style: {\n              backgroundColor: '#222454',\n              borderColor: '#222454'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fab fa-google mr-2\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 89,\n              columnNumber: 29\n            }, this), \" Sign \", isLogin ? 'in' : 'up', \" with Google\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 88,\n            columnNumber: 25\n          }, this), authenticating && /*#__PURE__*/_jsxDEV(LoadingComponent, {\n            card: false\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 92,\n            columnNumber: 44\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(CenterPiece, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 80,\n    columnNumber: 9\n  }, this);\n};\n\n_s(LoginPage, \"Mt46UVMxPc76Bp9bwsDcYYaQP3s=\", false, function () {\n  return [useHistory];\n});\n\n_c = LoginPage;\nexport default LoginPage; // import axios from 'axios';\n// import React, { SyntheticEvent, useState } from 'react'\n// import { Redirect } from 'react-router-dom';\n// const Login=()=> {\n//   const [email, setEmail] = useState(\"\");\n//   const [password, setPassword] = useState(\"\");\n//   const [redirect, setRedirect] = useState(false)\n//   const [errors, setError]=useState(\"\")\n//   const handleLogin = async (e: SyntheticEvent) => {\n//     e.preventDefault();\n//     axios({\n//       url: \"/login\",\n//       method: \"POST\",\n//       data: JSON.stringify({\n//         email,\n//         password,\n//       }),\n//     })\n//       .then(async (res) => {\n//         console.log(res);\n//         const content = await res;\n//         const readData=content.data\n//         if (readData.status===200){\n//             setRedirect(true)\n//         }\n//         if(readData.status===401 && readData.message===\"Unauthorized\"){\n//           const response=`Please provide a valid email and password!`\n//           setError(response)\n//         }\n//       })\n//       .catch((err) => {\n//         setError(err.data.message)\n//         console.log(err.data);\n//       });\n//   };\n//   if(redirect){\n//     return  <Redirect to =\"/\"/>;\n//   }\n//     return (\n//       <div>\n//       <div className=\"err\">\n//         {errors}\n//       </div>\n//         <form onSubmit={handleLogin}>\n//         <h1 className=\"h3 mb-3 fw-normal\">Login</h1>\n//         <input\n//           type=\"email\"\n//           className=\"form-control\"\n//           placeholder=\"Email address\"\n//           required\n//           onChange={(e) => setEmail(e.target.value)}\n//         />\n//         <input\n//           type=\"password\"\n//           className=\"form-control\"\n//           required\n//           placeholder=\"Password\"\n//           onChange={(e) => setPassword(e.target.value)}\n//         />\n//         <button\n//           className=\"w-100 btn btn-lg btn-primary custom-btn\"\n//           type=\"submit\"\n//         >\n//           Login\n//         </button>\n//       </form>\n//       </div>\n//     )\n// }\n// export default  Login;\n\nvar _c;\n\n$RefreshReg$(_c, \"LoginPage\");","map":{"version":3,"sources":["/Users/macbook/quiz_run/quizrun/src/pages/login.tsx"],"names":["React","useContext","useState","useHistory","UserContext","Authenticate","SignInWithSocialMedia","SocialMediaPopup","logging","CenterPiece","Button","Card","CardBody","CardHeader","Container","ErrorText","LoadingComponent","Providers","Naviagtion","LoginPage","props","authenticating","setAuthenticating","error","setError","userContext","history","isLogin","window","location","pathname","includes","signInWithSocialMedia","provider","then","result","info","user","uid","name","displayName","email","fire_token","getIdToken","_user","userDispatch","type","payload","push","catch","message","google","backgroundColor","borderColor"],"mappings":"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","sourcesContent":["import React, { useContext, useState } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport UserContext from '../context/user';\nimport firebase from 'firebase';\nimport IPageProps from '../interfaces/pages';\nimport { Authenticate, SignInWithSocialMedia as SocialMediaPopup } from '../modules/auth';\nimport logging from '../config/logging';\nimport CenterPiece from '../components/centerpiece';\nimport { Button, Card, CardBody, CardHeader, Container } from 'reactstrap';\nimport ErrorText from '../components/error_text';\nimport LoadingComponent from '../components/loading_components/indes';\nimport { Providers } from '../config/firebase';\nimport Naviagtion from '../components/navigation';\n\nconst LoginPage: React.FunctionComponent<IPageProps> = (props) => {\n    const [authenticating, setAuthenticating] = useState<boolean>(false);\n    const [error, setError] = useState<string>('');\n\n    const userContext = useContext(UserContext);\n    const history = useHistory();\n    const isLogin = window.location.pathname.includes('login');\n\n    const signInWithSocialMedia = (provider: firebase.auth.AuthProvider) => {\n        if (error !== '') setError('');\n        setAuthenticating(true);\n        SocialMediaPopup(provider)\n            .then(async (result) => {\n                logging.info(result);\n\n                let user = result.user;\n                if (user) {\n                    let uid = user.uid;\n                    let name = user.displayName;\n                    let email = user.email\n\n                    if (name) {\n                        try {\n                            let fire_token = await user.getIdToken();\n\n                            /**if we get a token, auth with the backup */\n\n                            Authenticate(uid, name,email, fire_token, (error, _user) => {\n                                if (error) {\n                                    setError(error);\n                                    setAuthenticating(false);\n                                } else if (_user) {\n                                    userContext.userDispatch({ type: 'login', payload: { user: _user, fire_token } });\n                                    history.push('/');\n                                }\n                            });\n                        } catch (error) {\n                            setError('Invalid token.');\n                            logging.error(error);\n                            setAuthenticating(false);\n                        }\n                    } else {\n                        /**\n                         * We can set these manually with a new form\n                         * For example, the Twitter provider sometimes\n                         * does not provide a username as some users sign\n                         * up with a phone number.  Here you could ask\n                         * them to provide a name that would be displayed\n                         * on this website.\n                         * */\n                        setError('The identify provider is missing a display name.');\n                        setAuthenticating(false);\n                    }\n                } else {\n                    setError('The social media provider does not have enough information. Please try a different provider.');\n                    setAuthenticating(false);\n                }\n            })\n            .catch((error) => {\n                logging.error(error);\n                setAuthenticating(false);\n                setError(error.message);\n            });\n    };\n    return (\n        <Container fluid className=\"p-0\">\n            <Naviagtion />\n            <CenterPiece>\n                <Card>\n                    <CardHeader>{isLogin ? 'Login' : 'Sign Up'}</CardHeader>\n\n                    <CardBody>\n                        <ErrorText error={error} />\n                        <Button block disabled={authenticating} onClick={() => signInWithSocialMedia(Providers.google)} style={{ backgroundColor: '#222454', borderColor: '#222454' }}>\n                            <i className=\"fab fa-google mr-2\"></i> Sign {isLogin ? 'in' : 'up'} with Google\n                        </Button>\n\n                        {authenticating && <LoadingComponent card={false} />}\n                    </CardBody>\n                   \n                </Card>\n            </CenterPiece>\n            <CenterPiece>\n            \n            </CenterPiece>\n        </Container>\n    );\n};\n\nexport default LoginPage;\n\n// import axios from 'axios';\n// import React, { SyntheticEvent, useState } from 'react'\n// import { Redirect } from 'react-router-dom';\n\n// const Login=()=> {\n//   const [email, setEmail] = useState(\"\");\n//   const [password, setPassword] = useState(\"\");\n//   const [redirect, setRedirect] = useState(false)\n//   const [errors, setError]=useState(\"\")\n\n//   const handleLogin = async (e: SyntheticEvent) => {\n\n//     e.preventDefault();\n//     axios({\n//       url: \"/login\",\n//       method: \"POST\",\n//       data: JSON.stringify({\n//         email,\n//         password,\n//       }),\n//     })\n//       .then(async (res) => {\n//         console.log(res);\n\n//         const content = await res;\n//         const readData=content.data\n//         if (readData.status===200){\n//             setRedirect(true)\n//         }\n//         if(readData.status===401 && readData.message===\"Unauthorized\"){\n//           const response=`Please provide a valid email and password!`\n//           setError(response)\n//         }\n//       })\n//       .catch((err) => {\n//         setError(err.data.message)\n//         console.log(err.data);\n//       });\n\n//   };\n\n//   if(redirect){\n//     return  <Redirect to =\"/\"/>;\n//   }\n\n//     return (\n//       <div>\n//       <div className=\"err\">\n//         {errors}\n//       </div>\n//         <form onSubmit={handleLogin}>\n//         <h1 className=\"h3 mb-3 fw-normal\">Login</h1>\n\n//         <input\n//           type=\"email\"\n//           className=\"form-control\"\n//           placeholder=\"Email address\"\n//           required\n//           onChange={(e) => setEmail(e.target.value)}\n//         />\n\n//         <input\n//           type=\"password\"\n//           className=\"form-control\"\n//           required\n//           placeholder=\"Password\"\n//           onChange={(e) => setPassword(e.target.value)}\n//         />\n\n//         <button\n//           className=\"w-100 btn btn-lg btn-primary custom-btn\"\n//           type=\"submit\"\n//         >\n//           Login\n//         </button>\n//       </form>\n//       </div>\n//     )\n// }\n\n// export default  Login;\n"]},"metadata":{},"sourceType":"module"}