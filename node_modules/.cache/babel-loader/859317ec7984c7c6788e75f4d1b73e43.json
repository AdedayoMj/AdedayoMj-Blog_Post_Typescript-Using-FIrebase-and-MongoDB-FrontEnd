{"ast":null,"code":"var _jsxFileName = \"/Users/macbook/quiz_run/quizrun/src/pages/edit.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useContext, useEffect, useState } from 'react';\nimport { ContentState, EditorState, convertToRaw } from 'draft-js';\nimport UserContext from '../context/user';\nimport { Link, withRouter } from 'react-router-dom';\nimport axios from 'axios';\nimport config from '../config/config';\nimport logging from '../config/logging';\nimport htmlToDraft from 'html-to-draftjs';\nimport LoadingComponent from '../components/loading_components';\nimport draftToHtml from 'draftjs-to-html';\nimport { Editor } from 'react-draft-wysiwyg';\nimport { Container, Form, FormGroup, Label, Input, Button } from 'reactstrap';\nimport ErrorText from '../components/error_text';\nimport Header from '../components/header';\nimport SuccessText from '../components/success_text';\nimport 'react-draft-wysiwyg/dist/react-draft-wysiwyg.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst EditPage = props => {\n  _s();\n\n  const [_id, setId] = useState('');\n  const [title, setTitle] = useState('');\n  const [picture, setPicture] = useState('');\n  const [content, setContent] = useState('');\n  const [headline, setHeadline] = useState('');\n  const [editorState, setEditorState] = useState(EditorState.createEmpty());\n  const [saving, setSaving] = useState(false);\n  const [loading, setLoading] = useState(true);\n  const [success, setSuccess] = useState('');\n  const [error, setError] = useState('');\n  const {\n    user\n  } = useContext(UserContext).userState;\n  useEffect(() => {\n    let blogID = props.match.params.blogID;\n\n    if (blogID) {\n      setId(blogID);\n      getBlog(blogID);\n    } else {\n      setLoading(false);\n    } // eslint-disable-next-line\n\n  }, []);\n\n  const getBlog = async id => {\n    try {\n      const response = await axios({\n        method: 'GET',\n        url: `${config.server.url}/blogs/read/${id}`\n      });\n\n      if (response.status === (200 || 304)) {\n        if (user._id !== response.data.blog.author._id) {\n          logging.warn(`This blog is owned by someone else.`);\n          setId('');\n        } else {\n          let blog = response.data.blog;\n          setTitle(blog.title);\n          setContent(blog.content);\n          setHeadline(blog.headline);\n          setPicture(blog.picture || '');\n          /** Convert html string to draft JS */\n\n          const contentBlock = htmlToDraft(blog.content);\n          const contentState = ContentState.createFromBlockArray(contentBlock.contentBlocks);\n          const editorState = EditorState.createWithContent(contentState);\n          setEditorState(editorState);\n        }\n      } else {\n        setError(`Unable to retrieve blog ${_id}`);\n      }\n    } catch (error) {\n      setError(error.message);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const createBlog = async () => {\n    if (title === '' || headline === '' || content === '') {\n      setError('Please fill out all fields.');\n      setSuccess('');\n      return null;\n    }\n\n    setError('');\n    setSuccess('');\n    setSaving(true);\n\n    try {\n      const response = await axios({\n        method: 'POST',\n        url: `${config.server.url}/blogs/create`,\n        data: {\n          title,\n          picture,\n          headline,\n          content,\n          author: user._id\n        }\n      });\n\n      if (response.status === 201) {\n        setId(response.data.blog._id);\n        setSuccess('Blog posted.  You can continue to edit on this page.');\n      } else {\n        setError(`Unable to save blog.`);\n      }\n    } catch (error) {\n      setError(error.message);\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const editBlog = async () => {\n    if (title === '' || headline === '' || content === '') {\n      setError('Please fill out all fields.');\n      setSuccess('');\n      return null;\n    }\n\n    setError('');\n    setSuccess('');\n    setSaving(true);\n\n    try {\n      const response = await axios({\n        method: 'PATCH',\n        url: `${config.server.url}/blogs/update/${_id}`,\n        data: {\n          title,\n          picture,\n          headline,\n          content\n        }\n      });\n\n      if (response.status === 201) {\n        setSuccess('Blog updated.');\n      } else {\n        setError(`Unable to save blog.`);\n      }\n    } catch (error) {\n      setError(error.message);\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  if (loading) return /*#__PURE__*/_jsxDEV(LoadingComponent, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 154,\n    columnNumber: 25\n  }, this);\n  return /*#__PURE__*/_jsxDEV(Container, {\n    fluid: true,\n    className: \"p-0\",\n    children: [/*#__PURE__*/_jsxDEV(Header, {\n      image: \"https://startbootstrap.github.io/startbootstrap-clean-blog/img/home-bg.jpg\",\n      headline: \"\",\n      title: _id !== '' ? 'Edit Your Blog' : 'Create a Blog'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Container, {\n      className: \"mt-5 mb-5\",\n      children: [/*#__PURE__*/_jsxDEV(ErrorText, {\n        error: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Form, {\n        children: [/*#__PURE__*/_jsxDEV(FormGroup, {\n          children: [/*#__PURE__*/_jsxDEV(Label, {\n            for: \"title\",\n            style: {\n              color: 'white'\n            },\n            children: \"Title\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 162,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Input, {\n            type: \"text\",\n            name: \"title\",\n            value: title,\n            id: \"title\",\n            placeholder: \"Enter a title\",\n            disabled: saving,\n            onChange: event => {\n              setTitle(event.target.value);\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 163,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 161,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(FormGroup, {\n          children: [/*#__PURE__*/_jsxDEV(Label, {\n            for: \"picture\",\n            style: {\n              color: 'white'\n            },\n            children: \"Picture URL\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 176,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Input, {\n            type: \"text\",\n            name: \"picture\",\n            value: picture,\n            id: \"picture\",\n            placeholder: \"Picture URL\",\n            disabled: saving,\n            onChange: event => {\n              setPicture(event.target.value);\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 177,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(FormGroup, {\n          children: [/*#__PURE__*/_jsxDEV(Label, {\n            for: \"headline\",\n            style: {\n              color: 'white'\n            },\n            children: \"Headline\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 190,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Input, {\n            type: \"text\",\n            name: \"headline\",\n            value: headline,\n            id: \"headline\",\n            placeholder: \"Enter a headline\",\n            disabled: saving,\n            onChange: event => {\n              setHeadline(event.target.value);\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 191,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 189,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(FormGroup, {\n          children: [/*#__PURE__*/_jsxDEV(Label, {\n            style: {\n              color: 'white'\n            },\n            children: \"Content\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 204,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Editor, {\n            editorState: editorState,\n            wrapperClassName: \"card\",\n            editorClassName: \"card-body\",\n            onEditorStateChange: newState => {\n              setEditorState(newState);\n              setContent(draftToHtml(convertToRaw(newState.getCurrentContent())));\n            },\n            toolbar: {\n              options: ['inline', 'blockType', 'fontSize', 'list', 'textAlign', 'history', 'embedded', 'emoji', 'image'],\n              inline: {\n                inDropdown: true\n              },\n              list: {\n                inDropdown: true\n              },\n              textAlign: {\n                inDropdown: true\n              },\n              link: {\n                inDropdown: true\n              },\n              history: {\n                inDropdown: true\n              }\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 205,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 203,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(FormGroup, {\n          children: /*#__PURE__*/_jsxDEV(SuccessText, {\n            success: success\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 224,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 223,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(FormGroup, {\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            style: {\n              backgroundColor: '#222454'\n            },\n            block: true,\n            onClick: () => {\n              if (_id !== '') {\n                editBlog();\n              } else {\n                createBlog();\n              }\n            },\n            disabled: saving,\n            children: [/*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fas fa-save mr-1\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 239,\n              columnNumber: 29\n            }, this), _id !== '' ? 'Update' : 'Post']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 227,\n            columnNumber: 25\n          }, this), _id !== '' && /*#__PURE__*/_jsxDEV(Button, {\n            block: true,\n            color: \"success\",\n            tag: Link,\n            to: `/blogs/${_id}`,\n            children: \"Go to your blog post!\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 243,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 226,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(FormGroup, {\n          children: [/*#__PURE__*/_jsxDEV(Label, {\n            style: {\n              color: 'white'\n            },\n            children: \"Preview\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 249,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"border ql-container p-2\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                backgroundColor: 'white'\n              },\n              dangerouslySetInnerHTML: {\n                __html: content\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 251,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 250,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 248,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 160,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(ErrorText, {\n        error: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 156,\n    columnNumber: 9\n  }, this);\n};\n\n_s(EditPage, \"Czlv8sMrzZECvRs5Y+g63HtUF4g=\");\n\n_c = EditPage;\nexport default _c2 = withRouter(EditPage);\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"EditPage\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"sources":["/Users/macbook/quiz_run/quizrun/src/pages/edit.tsx"],"names":["React","useContext","useEffect","useState","ContentState","EditorState","convertToRaw","UserContext","Link","withRouter","axios","config","logging","htmlToDraft","LoadingComponent","draftToHtml","Editor","Container","Form","FormGroup","Label","Input","Button","ErrorText","Header","SuccessText","EditPage","props","_id","setId","title","setTitle","picture","setPicture","content","setContent","headline","setHeadline","editorState","setEditorState","createEmpty","saving","setSaving","loading","setLoading","success","setSuccess","error","setError","user","userState","blogID","match","params","getBlog","id","response","method","url","server","status","data","blog","author","warn","contentBlock","contentState","createFromBlockArray","contentBlocks","createWithContent","message","createBlog","editBlog","color","event","target","value","newState","getCurrentContent","options","inline","inDropdown","list","textAlign","link","history","backgroundColor","__html"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect, useState } from 'react';\nimport IPageProps from '../interfaces/pages';\nimport { ContentState, EditorState, convertToRaw } from 'draft-js';\nimport UserContext from '../context/user';\nimport { Link, RouteComponentProps, withRouter } from 'react-router-dom';\nimport axios from 'axios';\nimport config from '../config/config';\nimport logging from '../config/logging';\nimport htmlToDraft from 'html-to-draftjs';\nimport IBlog from '../interfaces/blog';\nimport LoadingComponent from '../components/loading_components';\nimport draftToHtml from 'draftjs-to-html';\nimport { Editor } from 'react-draft-wysiwyg';\nimport { Container, Form, FormGroup, Label, Input, Button } from 'reactstrap';\nimport ErrorText from '../components/error_text';\nimport Header from '../components/header';\nimport SuccessText from '../components/success_text';\nimport 'react-draft-wysiwyg/dist/react-draft-wysiwyg.css';\n\nconst EditPage: React.FunctionComponent<IPageProps & RouteComponentProps<any>> = (props) => {\n    const [_id, setId] = useState<string>('');\n    const [title, setTitle] = useState<string>('');\n    const [picture, setPicture] = useState<string>('');\n    const [content, setContent] = useState<string>('');\n    const [headline, setHeadline] = useState<string>('');\n    const [editorState, setEditorState] = useState<EditorState>(EditorState.createEmpty());\n\n    const [saving, setSaving] = useState<boolean>(false);\n    const [loading, setLoading] = useState<boolean>(true);\n    const [success, setSuccess] = useState<string>('');\n    const [error, setError] = useState<string>('');\n\n    const { user } = useContext(UserContext).userState;\n\n    useEffect(() => {\n        let blogID = props.match.params.blogID;\n\n        if (blogID) {\n            setId(blogID);\n            getBlog(blogID);\n        } else {\n            setLoading(false);\n        }\n\n        // eslint-disable-next-line\n    }, []);\n\n    const getBlog = async (id: string) => {\n        try {\n            const response = await axios({\n                method: 'GET',\n                url: `${config.server.url}/blogs/read/${id}`\n            });\n\n            if (response.status === (200 || 304)) {\n                if (user._id !== response.data.blog.author._id) {\n                    logging.warn(`This blog is owned by someone else.`);\n                    setId('');\n                } else {\n                    let blog = response.data.blog as IBlog;\n                    setTitle(blog.title);\n                    setContent(blog.content);\n                    setHeadline(blog.headline);\n                    setPicture(blog.picture || '');\n\n                    /** Convert html string to draft JS */\n                    const contentBlock = htmlToDraft(blog.content);\n                    const contentState = ContentState.createFromBlockArray(contentBlock.contentBlocks);\n                    const editorState = EditorState.createWithContent(contentState);\n\n                    setEditorState(editorState);\n                }\n            } else {\n                setError(`Unable to retrieve blog ${_id}`);\n            }\n        } catch (error) {\n            setError(error.message);\n        } finally {\n            setLoading(false);\n        }\n    };\n    const createBlog = async () => {\n        if (title === '' || headline === '' || content === '') {\n            setError('Please fill out all fields.');\n            setSuccess('');\n            return null;\n        }\n\n        setError('');\n        setSuccess('');\n        setSaving(true);\n\n        try {\n            const response = await axios({\n                method: 'POST',\n                url: `${config.server.url}/blogs/create`,\n                data: {\n                    title,\n                    picture,\n                    headline,\n                    content,\n                    author: user._id\n                }\n            });\n\n            if (response.status === 201) {\n                setId(response.data.blog._id);\n                setSuccess('Blog posted.  You can continue to edit on this page.');\n            } else {\n                setError(`Unable to save blog.`);\n            }\n        } catch (error) {\n            setError(error.message);\n        } finally {\n            setSaving(false);\n        }\n    };\n\n    const editBlog = async () => {\n        if (title === '' || headline === '' || content === '') {\n            setError('Please fill out all fields.');\n            setSuccess('');\n            return null;\n        }\n\n        setError('');\n        setSuccess('');\n        setSaving(true);\n\n        try {\n            const response = await axios({\n                method: 'PATCH',\n                url: `${config.server.url}/blogs/update/${_id}`,\n                data: {\n                    title,\n                    picture,\n                    headline,\n                    content\n                }\n            });\n\n            if (response.status === 201) {\n                setSuccess('Blog updated.');\n            } else {\n                setError(`Unable to save blog.`);\n            }\n        } catch (error) {\n            setError(error.message);\n        } finally {\n            setSaving(false);\n        }\n    };\n\n    if (loading) return <LoadingComponent />;\n    return (\n        <Container fluid className=\"p-0\" >\n            <Header image=\"https://startbootstrap.github.io/startbootstrap-clean-blog/img/home-bg.jpg\" headline=\"\" title={_id !== '' ? 'Edit Your Blog' : 'Create a Blog'} />\n            <Container className=\"mt-5 mb-5\">\n                <ErrorText error={error} />\n                <Form>\n                    <FormGroup>\n                        <Label for=\"title\" style={{ color: 'white' }}>Title</Label>\n                        <Input\n                            type=\"text\"\n                            name=\"title\"\n                            value={title}\n                            id=\"title\"\n                            placeholder=\"Enter a title\"\n                            disabled={saving}\n                            onChange={(event) => {\n                                setTitle(event.target.value);\n                            }}\n                        />\n                    </FormGroup>\n                    <FormGroup>\n                        <Label for=\"picture\" style={{ color: 'white' }}>Picture URL</Label>\n                        <Input\n                            type=\"text\"\n                            name=\"picture\"\n                            value={picture}\n                            id=\"picture\"\n                            placeholder=\"Picture URL\"\n                            disabled={saving}\n                            onChange={(event) => {\n                                setPicture(event.target.value);\n                            }}\n                        />\n                    </FormGroup>\n                    <FormGroup>\n                        <Label for=\"headline\" style={{ color: 'white' }}>Headline</Label>\n                        <Input\n                            type=\"text\"\n                            name=\"headline\"\n                            value={headline}\n                            id=\"headline\"\n                            placeholder=\"Enter a headline\"\n                            disabled={saving}\n                            onChange={(event) => {\n                                setHeadline(event.target.value);\n                            }}\n                        />\n                    </FormGroup>\n                    <FormGroup>\n                        <Label style={{ color: 'white' }}>Content</Label>\n                        <Editor\n                            editorState={editorState}\n                            wrapperClassName=\"card\"\n                            editorClassName=\"card-body\"\n                            onEditorStateChange={(newState) => {\n                                setEditorState(newState);\n                                setContent(draftToHtml(convertToRaw(newState.getCurrentContent())));\n                            }}\n                            toolbar={{\n                                options: ['inline', 'blockType', 'fontSize', 'list', 'textAlign', 'history', 'embedded', 'emoji', 'image'],\n                                inline: { inDropdown: true },\n                                list: { inDropdown: true },\n                                textAlign: { inDropdown: true },\n                                link: { inDropdown: true },\n                                history: { inDropdown: true }\n                            }}\n                        />\n                    </FormGroup>\n                    <FormGroup>\n                        <SuccessText success={success} />\n                    </FormGroup>\n                    <FormGroup>\n                        <Button\n                            style={{ backgroundColor: '#222454' }}\n                            block\n                            onClick={() => {\n                                if (_id !== '') {\n                                    editBlog();\n                                } else {\n                                    createBlog();\n                                }\n                            }}\n                            disabled={saving}\n                        >\n                            <i className=\"fas fa-save mr-1\"></i>\n                            {_id !== '' ? 'Update' : 'Post'}\n                        </Button>\n                        {_id !== '' && (\n                            <Button block color=\"success\" tag={Link} to={`/blogs/${_id}`}>\n                                Go to your blog post!\n                            </Button>\n                        )}\n                    </FormGroup>\n                    <FormGroup>\n                        <Label style={{ color: 'white' }}>Preview</Label>\n                        <div className=\"border ql-container p-2\" >\n                            <div\n                            style={{ backgroundColor: 'white' }}\n                                dangerouslySetInnerHTML={{\n                                    __html: content\n                                }}\n                            />\n                        </div>\n                    </FormGroup>\n                </Form>\n                <ErrorText error={error} />\n            </Container>\n        </Container>\n    );\n};\n\nexport default withRouter(EditPage);\n"]},"metadata":{},"sourceType":"module"}